schema: '2.0'
stages:
  prepare:
    cmd: uv run -m travel_agent.pipeline.prepare
    deps:
    - path: data/raw/geo-reviews-dataset-2023.csv
      hash: md5
      md5: fc32c6fb5c1efecdc836f2749e1c4673
      size: 363459109
    - path: travel_agent/pipeline/prepare.py
      hash: md5
      md5: ffb5e2e394209ae909c8bc29e3f80015
      size: 1124
    params:
      params.yaml:
        prepare:
          dataset: data/raw/geo-reviews-dataset-2023.csv
          out_dir: data/prepared
          cities:
          - Москва
          - Санкт-Петербург
    outs:
    - path: data/prepared
      hash: md5
      md5: 08a719dcf6213956344112c4ed39e0ef.dir
      size: 116892430
      nfiles: 2
  generate_questions:
    cmd: uv run -m travel_agent.pipeline.generate_questions
    deps:
    - path: data/prepared/moskva.csv
      hash: md5
      md5: 5b2d8f87fff971ff2ac381eea6d362c8
      size: 78122812
    - path: travel_agent/pipeline/generate_questions.py
      hash: md5
      md5: 90c08f98a8c297dc5236967bd05b4951
      size: 4269
    params:
      params.yaml:
        generate_questions:
          seed: 2025
          dataset: data/prepared/moskva.csv
          out_dir: data/questions
          out_filename: questions.csv
          n_questions:
            rubric: 20
            address: 20
            rating_and_rubric: 10
            keyword: 5
            rating: 3
          keywords:
          - вкусный кофе
          - удобное расположение
          - онлайн-сервис
          - атмосфера
          - объёмные ресницы
    outs:
    - path: data/questions/questions.csv
      hash: md5
      md5: 938087e5b93f9d2544bb25e1b2ceb0ed
      size: 2947093
  embed:
    cmd: uv run -m travel_agent.pipeline.embed
    deps:
    - path: data/questions/questions.csv
      hash: md5
      md5: 938087e5b93f9d2544bb25e1b2ceb0ed
      size: 2947093
    params:
      params.yaml:
        embed:
          todo: true
